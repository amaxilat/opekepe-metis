<!DOCTYPE HTML>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/base :: head"></head>
<body>

<nav th:fragment="navbar" class="navbar navbar-expand-lg navbar-dark bg-dark static-top">
    <div class="container">
        <a class="navbar-brand" href="/">
            <img th:src="@{/img/metis.png}" width="30" height="30" class="d-inline-block align-top" alt=""/>
            <span th:text="${appName}">AppName</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive"
                aria-controls="navbarResponsive"
                aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link">
                        <span id="dot"
                              style="height: 15px;  width: 15px;  background-color: #bbb;  border-radius: 50%;  display: inline-block;"></span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link">
                        Θέσεις:
                        &nbsp;
                        <span id="pool-active" th:text="${pool.active}">0</span>
                        /
                        <span id="pool-max" th:text="${pool.max}">0</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link">
                        Ουρά:
                        &nbsp;
                        <span id="pool-pending" th:text="${pool.pending}">0</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<!-- Topbar -->
<nav th:fragment="navbar2" class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">

    <!-- Sidebar Toggle (Topbar) -->
    <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
        <i class="fa fa-bars"></i>
    </button>

    <!-- Topbar Navbar -->
    <ul class="navbar-nav ml-auto">

        <li class="nav-item no-arrow mx-1">
            <a class="nav-link">
                        <span id="dot"
                              style="height: 15px;  width: 15px;  background-color: #bbb;  border-radius: 50%;  display: inline-block;"></span>
            </a>
        </li>
        <li class="nav-item no-arrow mx-1">
            <a class="nav-link" style="color: #5a5c69; font-weight: bold">
                Θέσεις:
                &nbsp;
                <span id="pool-active" th:text="${pool.active}">0</span>
                /
                <span id="pool-max" th:text="${pool.max}">0</span>
            </a>
        </li>
        <li class="nav-item no-arrow mx-1">
            <a class="nav-link" style="color: #5a5c69; font-weight: bold">
                Ουρά:
                &nbsp;
                <span id="pool-pending" th:text="${pool.pending}">0</span>
            </a>
        </li>

    </ul>

</nav>
<!-- End of Topbar -->
<!-- Sidebar -->
<ul th:fragment="sidebar2" class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion" id="accordionSidebar">

    <!-- Sidebar - Brand -->
    <a class="sidebar-brand d-flex align-items-center justify-content-center" href="/">
        <div class="sidebar-brand-text mx-3">
            <img th:src="@{/img/metis.png}" width="30" height="30" class="d-inline-block align-top" alt=""/>
            <span th:text="${appName}">AppName</span>
        </div>
    </a>

    <!-- Divider -->
    <hr class="sidebar-divider my-0">

    <!-- Nav Item - Dashboard -->
    <li class="nav-item" th:classappend="${#request.requestURI=='/' ? 'active':''}">
        <a class="nav-link" href="/">
            <i class="fas fa-file-contract"></i>
            <span>Αναφορές</span>
        </a>
    </li>

    <!-- Divider -->
    <hr class="sidebar-divider my-0">

    <li class="nav-item"
        th:classappend="${#request.requestURI.startsWith('/view') ? 'active':''}">
        <a class="nav-link" href="#" data-toggle="collapse" data-target="#collapseDirs" aria-expanded="true"
           aria-controls="collapseTwo">
            <i class="fas fa-folder"></i>
            <span>Φάκελοι</span>
        </a>

        <div id="collapseDirs" class="collapse show" aria-labelledby="headingTwo" data-parent="#accordionSidebar"
             style="">
            <div class="bg-white py-2 collapse-inner rounded">
                <th:block th:each="imageDirectory: ${imageDirectories}">
                    <a class="collapse-item"
                       th:classappend="${imageDir !=null && imageDirectory.name==imageDir}?'active':''"
                       th:href="'/view/'+${imageDirectory.hash}"
                       th:text="${imageDirectory.name}">DirName</a>

                </th:block>
            </div>
        </div>
    </li>

    <!-- Sidebar Toggler (Sidebar) -->
    <div class="text-center d-none d-md-inline">
        <script th:inline="javascript">
            /*<![CDATA[*/
            const image_scan_url = [[${T(com.amaxilatis.metis.server.web.controller.ApiRoutes).API_SCAN_IMAGES}]];

            /*]]>*/
            function updateFiles() {
                $.get(image_scan_url, function (result) {
                    location.reload();
                });
            }
        </script>
        <button class="rounded-circle border-0" id="sidebarToggle" onclick="updateFiles()" title="Ανανέωση Εικόνων">
        </button>
    </div>

    <!-- Divider -->
    <hr class="sidebar-divider my-0">

    <!-- Nav Item - Dashboard -->
    <li class="nav-item" th:classappend="${#request.requestURI=='/settings' ? 'active':''}">
        <a class="nav-link" href="/settings">
            <i class="fas fa-cogs"></i>
            <span>Ρυθμίσεις</span>
        </a>
    </li>

    <!-- Divider -->
    <hr class="sidebar-divider d-none d-md-block">


</ul>
<!-- End of Sidebar -->

<th:block th:replace="fragments/base :: script"></th:block>

</body>
</html>
