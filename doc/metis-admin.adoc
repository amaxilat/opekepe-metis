= METIS - Εφαρμογή Για Το Μαζικό Έλεγχο Ορθοφωτοχαρτών
:author: ΦΩΤΟΠΟ ΑΝΩΝΥΜΟΣ ΕΤΑΙΡΕΙΑ ΜΕΛΕΤΩΝ ΑΝΑΠΤΥΞΗΣ & ΓΕΩΓΡΑΦΙΚΩΝ ΣΥΣΤΗΜΑΤΩΝ ΠΛΗΡΟΦΟΡΙΩΝ
:revnumber: 0.10.0
:description: Ο οδηγός αυτός περιγράφει τη παραμετροποίηση / διαχείριση της εφαρμογής Metis για τον μαζικό έλεγχο ορθοφωτοχαρτών από τον διαχειριστή του συστήματος.
:doctype: book
:sectanchors:
:sectlinks:
:toc: left
:sectnums:
:appendix-caption: Παράρτημα
:appendix-refsig: {appendix-caption}
:caution-caption: Προσοχή
:chapter-signifier: Κεφάλαιο
:chapter-refsig: {chapter-signifier}
:example-caption: Παράδειγμα
:figure-caption: Εικόνα
:important-caption: Σημαντικό
:last-update-label: Τελευταία ενημέρωση
ifdef::listing-caption[:listing-caption: Καταχώρηση]
ifdef::manname-title[:manname-title: Ονομα]
:note-caption: Σημείωση
:part-signifier: Μέρος
:part-refsig: {part-signifier}
ifdef::preface-title[:preface-title: Πρόλογος]
:section-refsig: Ενότητα
:table-caption: Πίνακας
:tip-caption: Υπόδειξη
:toc-title: Πίνακας Περιεχομένων
:untitled-label: Χωρίς τίτλο
:version-label: Έκδοση
:warning-caption: Προειδοποίηση

{description}

== Εκτέλεση Εφαρμογής

Η εφαρμογή εκτελείται ως Window Service ακολουθώντας τα βήματα περιγράφονται παρακάτω για την εγκατάστασή της, την διαχείρησή της καθώς και την λήψη αντιγράφων ασφαλείας από αυτήν.


=== Windows Service

Η εφαρμογή `Metis` εκτελείται ως Windows Service και για την εγκατάστασή της απαιτείται η εκτέλεση της παρακάτω εντολής μέσα στον αντίστοιχο φάκελο του release πακέτου της εφαρμογής.


```
Metis.exe install Metis.xml
```

== Παραμετροποίηση Εφαρμογής

Για την παραμετροποίηση της εφαρμογής χρησιμοποιείται το αρχείο `local.yml` το οποίο μας επιτρέπει να τροποποιήσουμε παραμέτρους όπως:

1.

Μετά από κάθε αλλαγή στις παραμέτρους της εφαρμογής απαιτείται επανεκκίνηση της με την διαδικασία που περιγράφεται παρακάτω.

=== Επανεκκίνηση Εφαρμογής

Για την επανεκκίνηση της εφαρμογής χρειάζεται να συνδεθούμε στο VM το οποίο εκτελεί την εφαρμογή και να ανοίξουμε την καρτέλα `Services` του `Task Manager`.
Εκεί στο service με όνομα `Metis` με δεξί κλίκ μπορούμε να επιλέξουμε `Restart` για την επανεκκίνησή της.

.Επανεκκίνηση Εφαρμογής
[#service-restart]
image::img-admin/service.png[align="center"]

=== Μετατροπή Certificate

Η εφαρμογή χρησιμοποιεί SSL certificates μορφής `.p12` για την φόρτωση του πιστοποιητικού και του αντίστοιχου private key.
Για τη μετατροπή του πιστοποιητικού από τη μορφή `.pfx` γίνεται χρήση του εργαλείου `keytool` του `jdk` μέσω της παρακάτω εντολής:

```
keytool.exe -importkeystore -destkeystore metiscert.p12 -deststoretype pkcs12 -srckeystore source.pfx
```

Με την εκτέλεση της εφαρμογής θα πρέπει να δωθεί από το χρήστη ένας κωδικός για την αποθήκευση του keystore στη μορφή `.p12` καθώς και ο κωδικός του `.pfx` keystore.

Το keystore που δημιουργείται πρέπει να τοποθετηθεί μέσα στο φάκελο της εφαρμογής και να γίνει επανεκκίνηση της εφαρμογής για να φορτωθεί το νέο certificate.

== Αντίγραφα Ασφαλείας

=== Λήψη Αντιγράφων Ασφαλείας

.Λήψη Αντιγράφων Ασφαλείας - Γενικά
[#backup-1]
image::img-admin/backup-1.png[align="center"]
.Λήψη Αντιγράφων Ασφαλείας - Triggers
[#backup-2]
image::img-admin/backup-2.png[align="center"]
.Λήψη Αντιγράφων Ασφαλείας - Actions
[#backup-3]
image::img-admin/backup-3.png[align="center"]

=== Εκκαθάριση Αντιγράφων Ασφαλείας

.Εκκαθάριση Αντιγράφων Ασφαλείας - Γενικά
[#clean-1]
image::img-admin/clean-1.png[align="center"]
.Εκκαθάριση Αντιγράφων Ασφαλείας - Triggers
[#clean-2]
image::img-admin/clean-2.png[align="center"]
.Εκκαθάριση Αντιγράφων Ασφαλείας - Actions
[#clean-3]
image::img-admin/clean-3.png[align="center"]

== Υποεφαρμογή Ελέγχου Νεοφοκάλυψης

Η υποεφαρμογή Ελέγχου Νεοφοκάλυψης `DetectorServer` είναι απαραίτητη για την εκτέλεση του `ελέγχου 4` της εφαρμογής `Metis`. Προκειται για μια εφαρμογή Μηχανικής Μάθησης που χρησημοποιεί την πλατφόρμα tensorflow για τον τμηματικό έλεγχο και αναγνώριση νεφών στους ορθοφωτοχάρτες που ελέγχονται.

=== Εκτέλεση Εφαρμογής

Η εφαρμογή εκτελείται ως Window Service ακολουθώντας αντίστοιχα βήματα με την εφαρμογή `Metis`.

==== Windows Service

Η υποεφαρμογή DetectorServer εκτελείται επίσης ως Windows Service όπως και η κύρια εφαρμογή Metis, και για την εγκατάστασή της απαιτείται η εκτέλεση της παρακάτω εντολής μέσα στον φάκελο DetectorServer του release πακέτου της εφαρμογής.

```
DetectorServer.exe install DetectorServer.xml
```

=== Παραμετροποίηση Εφαρμογής

Η εφαρμογή `DetectorServer` δεν διαθέτει κάποιες επιλογές παραμετροποίησης όπως η εφαρμογή `Μetis`. Παρ' όλα αυτά το μοντέλο με το οποία θα εκτελέσει την αναγνώριση των νεφών στα τμήματα των ορθοφωτοχαρτών φορτώνεται από τον υποφάκελο model που παρέχεται στο release πακέτο της εφαρμογής.


==== Επανεκκίνηση Εφαρμογής

Για την επανεκκίνηση της εφαρμογής χρειάζεται να συνδεθούμε στο VM το οποίο εκτελεί την εφαρμογή και να ανοίξουμε την καρτέλα `Services` του `Task Manager`.
Εκεί στο service με όνομα `DetectorServer` με δεξί κλίκ μπορούμε να επιλέξουμε `Restart` για την επανεκκίνησή της.

.Επανεκκίνηση Εφαρμογής
[#service-restart-1]
image::img-admin/service.png[align="center"]
